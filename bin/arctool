#!/usr/bin/env python
"""Manage archiving of data."""

import click

from dtool import (
  create_archive, 
  create_manifest, 
  new_archive,
  generate_slurm_compress_script
)


@click.group()
def cli():
    pass


@cli.command()
@click.option('--staging_path',
              help='Path to staging area where new archive will be created',
              default='.',
              type=click.Path(exists=True))
def new(staging_path):
    print('Starting new archive in {}'.format(staging_path))
    new_archive(staging_path)


@cli.group()
def manifest():
    pass


@manifest.command()
@click.argument('path', 'Path to archive directory.',
                type=click.Path(exists=True))
def create(path):
    create_manifest(path)


@cli.group()
def archive():
    pass

@archive.command()
@click.argument('path', 'Path to dataset directory.',
                type=click.Path(exists=True))
def create(path):
    create_archive(path)

@archive.command()
@click.argument('path', 'Path to uncompressed archive (tar) file.',
                type=click.Path(exists=True))
def compress(path):
    script = generate_slurm_compress_script(path)

    print(script)

if __name__ == "__main__":
    cli()
